![image](full.png)

На нем изображена схема sp-сети, через которую был обработан двоичный текст, с заданной таблицей замены и порядком перестановки. Замена осуществляется блоками по 3 бита (таблицу замены можно представить в двоичном виде), перестановка блоками по 9 бит, соответственно исходный текст был разделен на блоки по 9 бит и каждый блок шифровался отдельно. Также задан первичный ключ (101110110) и количество раундов (64).
Шифрование каждого блока открытого текста по схеме осуществлялось в следующем порядке 64 раза:
    1. Новый ключ получается прибавлением единицы (на первом раунде 101110110 + 1 = 101110111).
    2. Блок открытого текста складывается по модулю 2 (XOR) с полученным ключом.
    3. Происходила замена каждых трех бит по таблице S.
    4. Перестановка каждого бита по рисунку.
```
block[5] + block[6] + block[3] + block[8] + block[1] + block[7] + block[0] + block[4] + block[2]
```


В задании был дан уже зашифрованный текст, значит действия должны выполняться в обратном порядке также 64 раза для каждого блока шифртекста, причем ключ на последнем раунде шифрования равен 110110110 (1011101102 + 6410 ), поэтому для расшифровке используем его как первый:
  1. Перестановка по рисунку в обратную сторону.
```
block[6] + block[4] + block[8] + block[2] + block[7] + block[0] + block[1] + block[5] + block[3]
```
    
  2. Замена по таблице также в обратную сторону.
  4. Полученный блок складывается по модулю 2 (XOR) с раундовым ключом. 
  5. Из ключа вычитается единица (110110110 – 1 = 110110101 и т.д.). 
При расшифровке полученного двоичного кода получается флаг
